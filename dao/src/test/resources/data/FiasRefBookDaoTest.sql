-- Фиас
INSERT INTO ref_book (id, name, visible, type, read_only, region_attribute_id, table_name) VALUES (1030,'ФИАС Реестр адресообразующих объектов',0,0,1,null, 'fias_addrobj');

insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, id, AOID, SHORTNAME) values ('1', 0, 'Адыгея', 1, '385000', null, '01', 1, 1, 'Респ');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('4', 0, 'Майкоп', 1, null, 1, '01', 2, 2, 'г');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Абадзехская', 1, '385000', 2, '01', 3, 3, 'ул');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Авиационный', 1, '385006', 2, '01', 4, 4, 'пер');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Абрикосовая', 1, '385000', 2, '01', 5, 5, 'ул');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Автодорога 7', 1, '385019', 2, '01', 6, 6, 'ул');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Армавирская', 1, '385000', 2, '01', 7, 7, 'ул');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Апшеронская', 1, '385003', 2, '01', 8, 8, 'ул');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Андрухаева', 1, '385006', 2, '01', 9, 9, 'пер');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Ашхамафа', 1, '385007', 2, '01', 10, 10, 'ул');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Адыгейская', 1, null, 2, '01', 11, 11, 'ул');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Аэродромная', 1, null, 2, '01', 12, 12, 'ул');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Ачмизова', 1, '385000', 2, '01', 13, 13, 'ул');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Армейская', 1, '385019', 2, '01', 14, 14, 'ул');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Ветеранов 2-я', 1, '385007', 2, '01', 15, 15, 'ул');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Батарейная', 1,  null, 2, '01', 16, 16, 'ул');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Вишневый', 1, '385012', 2, '01', 17, 17, 'пер');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Верещагина', 1, null, 2, '01', 18, 18, 'ул');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Братьев Лоскутовых', 1, '385009', 2, '01', 19, 19, 'ул');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Весенняя', 1, '385009', 2, '01', 20, 20, 'ул');
insert into FIAS_ADDROBJ(AOLEVEL, CURRSTATUS, FORMALNAME, LIVESTATUS, POSTALCODE, PARENTGUID, REGIONCODE, ID, AOID, SHORTNAME) VALUES ('7', 0, 'Вишневая', 1, '385009', 2, '01', 21, 21, 'ул');

-- Запрос в com.aplana.sbrf.taxaccounting.dao.refbook.FiasRefBookDao.findAddress
-- WITH parent_to_child AS
--   (SELECT DISTINCT fa.id, fa.parentguid AS pid, fa.regioncode, fa.formalname AS fname, level AS aolevel, connect_by_isleaf AS isleaf, fa.currstatus AS status, connect_by_root fa.formalname AS ancestor, sys_connect_by_path(fa.formalname, '#') AS aopath
--   FROM fias_addrobj fa
--   WHERE REPLACE(lower(fa.formalname), ' ', '') = REPLACE(lower(:formalName), ' ', '')
--     START WITH fa.parentguid                  IS NULL
--   AND fa.regioncode                            = :regionCode
--     CONNECT BY prior fa.id                     = fa.parentguid
--   )
-- SELECT ptc.id, ptc.pid, ptc.regioncode, ptc.fname, ptc.aolevel, ptc.isleaf, ptc.aopath, ptc.ancestor
-- FROM parent_to_child ptc
-- WHERE REPLACE(lower(ptc.aopath), ' ', '') = REPLACE(lower(concat(concat('#', ptc.ancestor), :formalPath)), ' ', '')
-- AND ptc.status                            = 0
