<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                                       http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

    <changeSet id="2.2-ytrofimov-0" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script" valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_check.groovy"/>
            <where>id=2</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-1" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/consolidated_rnu_ndfl/v2016/consolidated_rnu_ndfl_check.groovy"/>
            <where>id=6</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-2" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/consolidated_rnu_ndfl/v2016/consolidated_rnu_ndfl_check.groovy"/>
            <where>id=6</where>
        </update>
    </changeSet>

    <!-- https://jira.aplana.com/browse/SBRFNDFL-3072 -->
    <changeSet id="2.2-ytrofimov-3" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_calculate.groovy"/>
            <where>id=1</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-4" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/consolidated_rnu_ndfl/v2016/consolidated_rnu_ndfl_check.groovy"/>
            <where>id=6</where>
        </update>
    </changeSet>

    <!-- https://jira.aplana.com/browse/SBRFNDFL-3076 -->
    <changeSet id="2.2-ytrofimov-5" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_calculate.groovy"/>
            <where>id=1</where>
        </update>
    </changeSet>

    <!--https://jira.aplana.com/browse/SBRFNDFL-2930 -->
    <changeSet id="2.2-afateev-0" author="afateev">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_calculate.groovy"/>
            <where>id=1</where>
        </update>
    </changeSet>

    <!--https://jira.aplana.com/browse/SBRFNDFL-2930 -->
    <changeSet id="2.2-afateev-1" author="afateev">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_calculate.groovy"/>
            <where>id=1</where>
        </update>
    </changeSet>

    <changeSet id="2.2-dnovikov-0" author="dnovikov">
        <update tableName="BLOB_DATA">
            <column name="data" valueBlobFile="templates/refbook/declaration_type.groovy"/>
            <where>id='352adf59-372b-4020-98fe-8960dd5bc972'</where>
        </update>
    </changeSet>

    <changeSet id="2.2-dnovikov-1" author="dnovikov">
        <update tableName="BLOB_DATA">
            <column name="data" valueBlobFile="templates/refbook/declaration_type.groovy"/>
            <where>id='352adf59-372b-4020-98fe-8960dd5bc972'</where>
        </update>
    </changeSet>

    <!-- https://jira.aplana.com/browse/SBRFNDFL-3076 -->
    <changeSet id="2.2-ytrofimov-6" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_calculate.groovy"/>
            <where>id=1</where>
        </update>
    </changeSet>

    <!-- https://jira.aplana.com/browse/SBRFNDFL-2750 -->
    <changeSet id="2.2-aokunev-1" author="aokunev">
        <update tableName="DECLARATION_TYPE">
            <column name="NAME" value="РНУ НДФЛ (первичная)"/>
            <where>id=100</where>
        </update>
        <update tableName="DECLARATION_TYPE">
            <column name="NAME" value="РНУ НДФЛ (консолидированная)"/>
            <where>id=101</where>
        </update>
        <update tableName="DECLARATION_TEMPLATE">
            <column name="NAME" value="РНУ НДФЛ (первичная)"/>
            <where>id=100</where>
        </update>
        <update tableName="DECLARATION_TEMPLATE">
            <column name="NAME" value="РНУ НДФЛ (консолидированная)"/>
            <where>id=101</where>
        </update>
    </changeSet>

    <!-- https://jira.aplana.com/browse/SBRFNDFL-3133 - проверка -->
    <changeSet id="2.2-dloshkarev-0" author="dloshkarev">
        <insert tableName="LOCK_DATA">
            <column name="id" value="1"/>
            <column name="key" value="TEST_LOCK"/>
            <column name="user_id" value="13276"/>
        </insert>
    </changeSet>
    <!-- https://jira.aplana.com/browse/SBRFNDFL-3133 - откат -->
    <changeSet id="2.2-dloshkarev-1" author="dloshkarev">
        <delete tableName="LOCK_DATA">
            <where>id = 1</where>
        </delete>
    </changeSet>

    <!-- https://jira.aplana.com/browse/SBRFNDFL-2891 -->
    <changeSet id="2.2-aokunev-2" author="aokunev">
        <update tableName="BLOB_DATA">
            <column name="data" valueBlobFile="templates/refbook/declaration_type.groovy"/>
            <where>id='352adf59-372b-4020-98fe-8960dd5bc972'</where>
        </update>
    </changeSet>

    <!-- https://jira.aplana.com/browse/SBRFNDFL-2583 -->
    <changeSet id="2.2-ytrofimov-7" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_calculate.groovy"/>
            <where>id=1</where>
        </update>
    </changeSet>

    <changeSet id="2.2-dnovikov-2" author="dnovikov">
        <update tableName="BLOB_DATA">
            <column name="data" valueBlobFile="templates/refbook/declaration_type.groovy"/>
            <where>id='352adf59-372b-4020-98fe-8960dd5bc972'</where>
        </update>
    </changeSet>

    <!-- https://jira.aplana.com/browse/SBRFNDFL-2583 -->
    <changeSet id="2.2-ytrofimov-8" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_calculate.groovy"/>
            <where>id=1</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-9" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script" valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_check.groovy"/>
            <where>id=2</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-10" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/consolidated_rnu_ndfl/v2016/consolidated_rnu_ndfl_check.groovy"/>
            <where>id=6</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-11" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_calculate.groovy"/>
            <where>id=1</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-12" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_calculate.groovy"/>
            <where>id=1</where>
        </update>
    </changeSet>

    <!--https://jira.aplana.com/browse/SBRFNDFL-3025 -->
    <changeSet id="2.2-dloshkarev-2" author="dloshkarev">
        <update tableName="DECLARATION_TEMPLATE">
            <column name="create_script" valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl.groovy"/>
            <where>id=100</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-13" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_calculate.groovy"/>
            <where>id=1</where>
        </update>
    </changeSet>

    <!-- https://jira.aplana.com/browse/SBRFNDFL-2583 -->
    <changeSet id="2.2-ytrofimov-14" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_calculate.groovy"/>
            <where>id=1</where>
        </update>
    </changeSet>

    <!-- https://jira.aplana.com/browse/SBRFNDFL-2583 -->
    <changeSet id="2.2-ytrofimov-15" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_calculate.groovy"/>
            <where>id=1</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-16" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_calculate.groovy"/>
            <where>id=1</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-17" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_calculate.groovy"/>
            <where>id=1</where>
        </update>
    </changeSet>

    <changeSet id="2.2-dnovikov-3" author="dnovikov">
        <sql>
            CREATE global TEMPORARY TABLE tmp_numbers0 (
                num NUMBER(18,0)
            ) ON COMMIT DELETE ROWS ;
            CREATE global TEMPORARY TABLE tmp_numbers1 (
                num NUMBER(18,0)
            ) ON COMMIT DELETE ROWS ;
        </sql>
    </changeSet>

	<!--https://jira.aplana.com/browse/SBRFNDFL-1382 Исправить наполнение справочника REF_BOOK_TARIFF_PAYER. Нужно удалить таблицу-->
	<changeSet id="2.1-rnurgaleev-0" author="rnurgaleev">
        <dropTable cascadeConstraints="true"
                   tableName="ref_book_tariff_payer"/>
    </changeSet>

	<changeSet id="2.2-rnurgaleev-1" author="rnurgaleev">
        <delete
                tableName="ref_book_attribute">
            <where>ref_book_id=938
            </where>
        </delete>
    </changeSet>

    <changeSet id="2.2-rnurgaleev-2" author="rnurgaleev">
        <delete
                tableName="ref_book">
            <where>table_name='REF_BOOK_TARIFF_PAYER'</where>
        </delete>
    </changeSet>

    <!--https://jira.aplana.com/browse/SBRFNDFL-2898 В журнале "Список налоговых форм" заменить кнопку "Рассчитать" на кнопки "Идентифицировать ФЛ" и "Консолидировать"-->
    <changeSet id="2.2-ytrofimov-18" author="ytrofimov">
        <insert tableName="async_task_type">
            <column name="id" value="8"/>
            <column name="name" value="Расчет налоговой формы (формирование XML-файла)"/>
            <column name="handler_bean" value="IdentifyAsyncTask"/>
            <column name="short_queue_limit" value="3000"/>
            <column name="limit_kind" value="Количество ФЛ в НФ"/>
        </insert>
    </changeSet>

    <changeSet id="2.2-ytrofimov-19" author="ytrofimov">
        <insert tableName="async_task_type">
            <column name="id" value="9"/>
            <column name="name" value="Расчет налоговой формы (формирование XML-файла)"/>
            <column name="handler_bean" value="ConsolidateAsyncTask"/>
            <column name="short_queue_limit" value="3000"/>
            <column name="limit_kind" value="Количество ФЛ в НФ"/>
        </insert>
    </changeSet>

    <!--https://jira.aplana.com/browse/SBRFNDFL-3062 -->
    <changeSet id="2.2-ytrofimov-22" author="ytrofimov">
        <update tableName="DECLARATION_TEMPLATE">
            <column name="create_script" valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl.groovy"/>
            <where>id=100</where>
        </update>
    </changeSet>

    <!--https://jira.aplana.com/browse/SBRFNDFL-3201 -->
    <changeSet id="2.2-ytrofimov-23" author="ytrofimov">
        <update tableName="BLOB_DATA">
            <column name="data" valueBlobFile="templates/refbook/declaration_type.groovy"/>
            <where>id='352adf59-372b-4020-98fe-8960dd5bc972'</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-24" author="ytrofimov">
        <update tableName="DECLARATION_TEMPLATE">
            <column name="CREATE_SCRIPT" valueClobFile="templates/ndfl/report_2ndfl_1/v2016/report_2ndfl.groovy"/>
            <where>id=102</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-25" author="ytrofimov">
        <update tableName="DECLARATION_TEMPLATE">
            <column name="CREATE_SCRIPT" valueClobFile="templates/ndfl/report_6ndfl/v2016/report_6ndfl.groovy"/>
            <where>id=103</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-26" author="ytrofimov">
        <update tableName="DECLARATION_TEMPLATE">
            <column name="CREATE_SCRIPT" valueClobFile="templates/ndfl/report_2ndfl_1/v2016/report_2ndfl.groovy"/>
            <where>id=104</where>
        </update> 
    </changeSet>
	
	<!--https://jira.aplana.com/browse/SBRFNDFL-3361 ФИАС: не находит адрес в справочнике-->
	<changeSet id="2.2-rnurgaleev-3" author="rnurgaleev">
        <sql splitStatements="false">
            declare
				v_count number;
			begin
				select count(1) into v_count from user_mviews where mview_name='MV_FIAS_LOCALITY_ACT';
				if v_count>0 then
					execute immediate 'DROP MATERIALIZED VIEW MV_FIAS_LOCALITY_ACT';
				end if;

				select count(1) into v_count from user_mviews where mview_name='MV_FIAS_LOCALITY_ACT';
				if v_count=0 then
					execute immediate 'CREATE MATERIALIZED VIEW MV_FIAS_LOCALITY_ACT (ID, AOID, FORMALNAME, SHORTNAME, REGIONCODE, LIVESTATUS, CURRSTATUS, AOLEVEL, POSTALCODE, PARENTGUID, FNAME, FTYPE, HAS_CHILD)
    NOLOGGING
    BUILD IMMEDIATE
    USING INDEX
    REFRESH COMPLETE ON DEMAND
    USING DEFAULT LOCAL ROLLBACK SEGMENT
    USING ENFORCED CONSTRAINTS DISABLE QUERY REWRITE
    AS select distinct f.id, f.aoid, f.formalname, f.shortname, f.regioncode, f.livestatus, f.currstatus, f.aolevel, f.postalcode, 
    nvl(d.parentguid,f.parentguid) parentguid,
       replace(lower(f.formalname),'' '','''') fname,
       trim(lower(f.shortname)) ftype,
       nvl2(c.id,1,0) has_child
    from fias_addrobj f left join fias_addrobj c on (c.parentguid=f.aoid and c.currstatus=0)
    left join fias_addrobj d on (f.parentguid=d.aoid and d.currstatus=0 and d.aolevel=5)
    where f.currstatus=0
    and f.aolevel in (6,90)';
	
					execute immediate 'CREATE INDEX IDX_MV_FIAS_LOCALITY_AOID ON MV_FIAS_LOCALITY_ACT (AOID)';
					execute immediate 'CREATE INDEX IDX_MV_FIAS_LOCALITY_FNAME ON MV_FIAS_LOCALITY_ACT (FNAME)';
					execute immediate 'CREATE INDEX IDX_MV_FIAS_LOCALITY_PGUID ON MV_FIAS_LOCALITY_ACT (PARENTGUID)';
					execute immediate 'CREATE INDEX SRCH_MV_FIAS_LOCAL_REG_FN_TP ON MV_FIAS_LOCALITY_ACT (REGIONCODE, FNAME, FTYPE, HAS_CHILD)';
					execute immediate 'CREATE UNIQUE INDEX PK_MV_FIAS_LOCALITY_ACT ON MV_FIAS_LOCALITY_ACT (ID)';

					execute immediate 'COMMENT ON COLUMN MV_FIAS_LOCALITY_ACT.ID IS ''Уникальный идентификатор''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_LOCALITY_ACT.AOID IS ''Идентификатор объекта''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_LOCALITY_ACT.FORMALNAME IS ''Формализованное наименование''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_LOCALITY_ACT.SHORTNAME IS ''Тип адресного объекта''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_LOCALITY_ACT.REGIONCODE IS ''Код региона''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_LOCALITY_ACT.LIVESTATUS IS ''Статус актуальности ФИАС: 1 - актуальная, 0 - устаревшая''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_LOCALITY_ACT.CURRSTATUS IS ''Статус актуальности КЛАДР: 0 - актуальная, ..''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_LOCALITY_ACT.AOLEVEL IS ''Уровень объекта''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_LOCALITY_ACT.POSTALCODE IS ''Почтовый индекс''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_LOCALITY_ACT.PARENTGUID IS ''Идентификатор родительского объекта''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_LOCALITY_ACT.FNAME IS ''Наименование, адаптированное для проверки адреса (строчными буквами, без пробелов)''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_LOCALITY_ACT.FTYPE IS ''Тип, адаптированный для проверки адреса (строчными буквами, без пробелов)''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_LOCALITY_ACT.HAS_CHILD IS ''Наличие дочерних элементов''';
					execute immediate 'COMMENT ON MATERIALIZED VIEW MV_FIAS_LOCALITY_ACT  IS ''Актуальные населенные пункты из справочника ФИАС''';
				end if;

				select count(1) into v_count from user_mviews where mview_name='MV_FIAS_STREET_ACT';
				if v_count>0 then
					execute immediate 'DROP MATERIALIZED VIEW MV_FIAS_STREET_ACT';
				end if;

				select count(1) into v_count from user_mviews where mview_name='MV_FIAS_STREET_ACT';
				if v_count=0 then
					execute immediate 'CREATE MATERIALIZED VIEW MV_FIAS_STREET_ACT (ID, AOID, FORMALNAME, SHORTNAME, REGIONCODE, LIVESTATUS, CURRSTATUS, AOLEVEL, POSTALCODE, PARENTGUID, FNAME, FTYPE, HAS_CHILD)
    NOLOGGING
    BUILD IMMEDIATE
    USING INDEX
    REFRESH COMPLETE ON DEMAND
    USING DEFAULT LOCAL ROLLBACK SEGMENT
    USING ENFORCED CONSTRAINTS DISABLE QUERY REWRITE
    AS select distinct f.id, f.aoid, f.formalname, f.shortname, f.regioncode, f.livestatus, f.currstatus, f.aolevel, f.postalcode, 
coalesce(e.parentguid,d.parentguid,f.parentguid) parentguid,
       replace(lower(f.formalname),'' '','''') fname,
       trim(lower(f.shortname)) ftype,
       nvl2(c.id,1,0) has_child
    from fias_addrobj f left join fias_addrobj c on (c.parentguid=f.aoid and c.currstatus=0)
    left join fias_addrobj d on (f.parentguid=d.aoid and d.currstatus=0 and d.aolevel in (5,65))
    left join fias_addrobj e on (d.parentguid=e.aoid and d.currstatus=0 and d.aolevel=65 and e.aolevel=5)
    where f.currstatus=0
    and f.aolevel in (7,91)';

					execute immediate 'CREATE UNIQUE INDEX PK_MV_FIAS_STREET_ACT ON MV_FIAS_STREET_ACT (ID)';
					execute immediate 'CREATE INDEX IDX_MV_FIAS_STREET_AOID ON MV_FIAS_STREET_ACT (AOID)';
					execute immediate 'CREATE INDEX IDX_MV_FIAS_STREET_FNAME ON MV_FIAS_STREET_ACT (FNAME)';
					execute immediate 'CREATE INDEX IDX_MV_FIAS_STREET_PGUID ON MV_FIAS_STREET_ACT (PARENTGUID)';
					execute immediate 'CREATE INDEX SRCH_MV_FIAS_STREET_REG_FN_TP ON MV_FIAS_STREET_ACT (REGIONCODE, FNAME, FTYPE, HAS_CHILD)';
					execute immediate 'CREATE INDEX IDX_MV_FIAS_STREET_POST ON MV_FIAS_STREET_ACT (POSTALCODE)';

					execute immediate 'COMMENT ON COLUMN MV_FIAS_STREET_ACT.ID IS ''Уникальный идентификатор''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_STREET_ACT.AOID IS ''Идентификатор объекта''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_STREET_ACT.FORMALNAME IS ''Формализованное наименование''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_STREET_ACT.SHORTNAME IS ''Тип адресного объекта''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_STREET_ACT.REGIONCODE IS ''Код региона''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_STREET_ACT.LIVESTATUS IS ''Статус актуальности ФИАС: 1 - актуальная, 0 - устаревшая''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_STREET_ACT.CURRSTATUS IS ''Статус актуальности КЛАДР: 0 - актуальная, ..''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_STREET_ACT.AOLEVEL IS ''Уровень объекта''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_STREET_ACT.POSTALCODE IS ''Почтовый индекс''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_STREET_ACT.PARENTGUID IS ''Идентификатор родительского объекта''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_STREET_ACT.FNAME IS ''Наименование, адаптированное для проверки адреса (строчными буквами, без пробелов)''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_STREET_ACT.FTYPE IS ''Тип, адаптированный для проверки адреса (строчными буквами, без пробелов)''';
					execute immediate 'COMMENT ON COLUMN MV_FIAS_STREET_ACT.HAS_CHILD IS ''Наличие дочерних элементов''';
					execute immediate 'COMMENT ON MATERIALIZED VIEW MV_FIAS_STREET_ACT  IS ''Актуальные улицы из справочника ФИАС''';
				end if;
			end;
        </sql>
    </changeSet>

    <!-- https://jira.aplana.com/browse/SBRFNDFL-3441 -->
    <changeSet id="2.2-ytrofimov-27" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_calculate.groovy"/>
            <where>id=1</where>
        </update>
    </changeSet>

    <!--https://jira.aplana.com/browse/SBRFNDFL-3259 -->
    <changeSet id="2.2-ytrofimov-28" author="ytrofimov">
        <update tableName="DECLARATION_TEMPLATE">
            <column name="create_script" valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl.groovy"/>
            <where>id=100</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-29" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script" valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_check.groovy"/>
            <where>id=2</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-30" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_import.groovy"/>
            <where>id=14</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-31" author="ytrofimov">
        <update tableName="DECLARATION_TEMPLATE">
            <column name="create_script"
                    valueClobFile="templates/ndfl/consolidated_rnu_ndfl/v2016/consolidated_rnu_ndfl.groovy"/>
            <where>id=101</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-32" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/consolidated_rnu_ndfl/v2016/consolidated_rnu_ndfl_calculate.groovy"/>
            <where>id=5</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-33" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/consolidated_rnu_ndfl/v2016/consolidated_rnu_ndfl_check.groovy"/>
            <where>id=6</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-34" author="ytrofimov">
        <update tableName="DECLARATION_TEMPLATE">
            <column name="CREATE_SCRIPT" valueClobFile="templates/ndfl/report_2ndfl_1/v2016/report_2ndfl.groovy"/>
            <where>id=102</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-35" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/report_2ndfl_1/v2016/report_2ndfll_check.groovy"/>
            <where>id=8</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-36" author="ytrofimov">
        <update tableName="DECLARATION_TEMPLATE">
            <column name="CREATE_SCRIPT" valueClobFile="templates/ndfl/report_6ndfl/v2016/report_6ndfl.groovy"/>
            <where>id=103</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-37" author="ytrofimov">
        <update tableName="DECLARATION_TEMPLATE">
            <column name="CREATE_SCRIPT" valueClobFile="templates/ndfl/report_2ndfl_1/v2016/report_2ndfl.groovy"/>
            <where>id=104</where>
        </update>
    </changeSet>

    <changeSet id="2.2-ytrofimov-38" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/report_2ndfl_1/v2016/report_2ndfll_check.groovy"/>
            <where>id=12</where>
        </update>
    </changeSet>

    <!--https://jira.aplana.com/browse/SBRFNDFL-3269 -->
    <changeSet id="2.2-ytrofimov-39" author="ytrofimov">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script"
                    valueClobFile="templates/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_calculate.groovy"/>
            <where>id=1</where>
        </update>
    </changeSet>

    <changeSet id="2.2-dnovikov-4" author="dnovikov">
        <update tableName="REPORT_PERIOD_TYPE">
            <column name="NAME" value="первый квартал при реорганизации (ликвидации) организации"/>
            <where>code='51'</where>
        </update>
    </changeSet>

    <changeSet id="2.2-dnovikov-5" author="dnovikov">
        <update tableName="REPORT_PERIOD_TYPE">
            <column name="NAME" value="полугодие при реорганизации (ликвидации) организации"/>
            <where>code='52'</where>
        </update>
    </changeSet>

    <changeSet id="2.2-dnovikov-6" author="dnovikov">
        <update tableName="REPORT_PERIOD_TYPE">
            <column name="NAME" value="9 месяцев при реорганизации (ликвидации) организации"/>
            <where>code='53'</where>
        </update>
    </changeSet>

</databaseChangeLog>