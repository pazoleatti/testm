<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                                       http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

	<changeSet id="3.7-dnovikov-1" author="dnovikov" runAlways="true">
		<update tableName="blob_data">
			<column name="data"
					valueBlobFile="templates-3.7/refbook/department_configs.groovy"/>
			<where>id = (select script_id from ref_book r where r.id = 951)</where>
		</update>
	</changeSet>

	<changeSet id="3.7-dnovikov-2" author="dnovikov" runAlways="true">
		<update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
			<column name="script" valueClobFile="templates-3.7/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_check.groovy"/>
			<where>DECLARATION_TEMPLATE_ID = 100 and EVENT_ID = 5</where>
		</update>
	</changeSet>

    <changeSet id="3.7-dnovikov-3" author="dnovikov" runAlways="true">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script" valueClobFile="templates-3.7/ndfl/consolidated_rnu_ndfl/v2016/consolidated_rnu_ndfl_calculate.groovy"/>
            <where>DECLARATION_TEMPLATE_ID = 101 and EVENT_ID = 3</where>
        </update>
    </changeSet>

	<changeSet id="3.7-dnovikov-4" author="dnovikov" runAlways="true">
		<update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
			<column name="script" valueClobFile="templates-3.7/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_import.groovy"/>
			<where>DECLARATION_TEMPLATE_ID = 100 and EVENT_ID = 7</where>
		</update>
	</changeSet>

	<changeSet id="3.7-dnovikov-5" author="dnovikov" runAlways="true">
		<update tableName="DECLARATION_TEMPLATE">
			<column name="CREATE_SCRIPT" valueClobFile="templates-3.7/ndfl/report_2ndfl_1/v2016/report_2ndfl.groovy"/>
			<where>declaration_type_id = 102</where>
		</update>
		<update tableName="DECLARATION_TEMPLATE">
			<column name="CREATE_SCRIPT" valueClobFile="templates-3.7/ndfl/report_2ndfl_1/v2016/report_2ndfl.groovy"/>
			<where>declaration_type_id = 104</where>
		</update>
		<update tableName="DECLARATION_TEMPLATE">
			<column name="CREATE_SCRIPT" valueClobFile="templates-3.7/ndfl/report_6ndfl/v2016/report_6ndfl.groovy"/>
			<where>declaration_type_id = 103</where>
		</update>
	</changeSet>

    <changeSet id="3.7-dnovikov-6" author="dnovikov" runAlways="true">
        <update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
            <column name="script" valueClobFile="templates-3.7/ndfl/consolidated_rnu_ndfl/v2016/consolidated_rnu_ndfl_check.groovy"/>
            <where>DECLARATION_TEMPLATE_ID = 101 and EVENT_ID = 5</where>
        </update>
    </changeSet>

	<!--https://jira.aplana.com/browse/SBRFNDFL-7159 Реализовать перенос пустых значений из Реестра ФЛ в Раздел 1 РНУ при обновлении данных ФЛ-->
	<changeSet id="3.5-ytrofimov-1" author="ytrofimov" runAlways="true">
		<update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
			<column name="script" valueClobFile="templates-3.5/ndfl/consolidated_rnu_ndfl/v2016/consolidated_rnu_ndfl_update_persons_data.groovy"/>
			<where>DECLARATION_TEMPLATE_ID = 101 and EVENT_ID = 11</where>
		</update>
	</changeSet>

	<!--https://jira.aplana.com/browse/SBRFNDFL-7159 Реализовать перенос пустых значений из Реестра ФЛ в Раздел 1 РНУ при обновлении данных ФЛ-->
	<changeSet id="3.5-ytrofimov-2" author="ytrofimov" runAlways="true">
		<update tableName="DECL_TEMPLATE_EVENT_SCRIPT">
			<column name="script" valueClobFile="templates-3.5/ndfl/primary_rnu_ndfl/v2016/primary_rnu_ndfl_update_persons_data.groovy"/>
			<where>DECLARATION_TEMPLATE_ID = 100 and EVENT_ID = 11</where>
		</update>
	</changeSet>

</databaseChangeLog>