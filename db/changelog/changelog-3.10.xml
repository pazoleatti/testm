<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                                       http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

    <!-- https://jira.aplana.com/browse/SBRFNDFL-8272 Реализовать добавление новых параметров в справочники -->
    <changeSet id="3.10-adudenko-01" author="adudenko">
        <sql>
            insert into ref_book_form_type(id, code, name) values(7, 'Приложение 2', 'Приложение 2');
            alter table report_period add form_type_id number(1);
        </sql>
    </changeSet>
    <changeSet id="3.10-adudenko-02" author="adudenko">
        <addForeignKeyConstraint baseColumnNames="form_type_id"
                                 baseTableName="report_period"
                                 constraintName="rp_fk_ref_book_form_type_id"
                                 onDelete="CASCADE"
                                 referencedColumnNames="id"
                                 referencedTableName="ref_book_form_type"/>
    </changeSet>

    <changeSet id="3.10-avoynov-1" author="avoynov" runAlways="true">
        <update tableName="DECLARATION_TEMPLATE">
            <column name="CREATE_SCRIPT" valueClobFile="templates-3.10/ndfl/report_2ndfl_1/v2016/report_2ndfl.groovy"/>
            <where>declaration_type_id = 102</where>
        </update>
        <update tableName="DECLARATION_TEMPLATE">
            <column name="CREATE_SCRIPT" valueClobFile="templates-3.10/ndfl/report_2ndfl_1/v2016/report_2ndfl.groovy"/>
            <where>declaration_type_id = 104</where>
        </update>
    </changeSet>

</databaseChangeLog>