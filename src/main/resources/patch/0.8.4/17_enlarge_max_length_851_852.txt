import groovy.transform.Field
import org.springframework.jndi.JndiTemplate

import javax.sql.DataSource

/**
 Обновляет максимальную длину для графы 5
 # Инструкция:
 1) Вставить текст данного скрипта на странице, соответствующей ссылке с окончанием:
 .../gwtapp/#!scriptExecution
 2) Нажать "Выполнить".

 */

@Field
def dataSourceName = 'jdbc/TaxAccDS-nonXA'

try {
    def template = new JndiTemplate()
    def DataSource dataSource = template.lookup(dataSourceName)
    def connection = dataSource.connection
    def stmt = connection.createStatement()
    stmt.executeQuery("UPDATE FORM_COLUMN SET max_length = 2000 where form_template_id in (851, 852) and alias = 'explanation'")
} catch (Exception ex) {
    logger.error("Error: ${ex.getLocalizedMessage()}")
}